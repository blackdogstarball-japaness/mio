<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥èªå­¸ç¿’å¤§å†’éšª - å®Œæ•´äº”åéŸ³èˆ‡æ‰¾å–®å­—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', 'Noto Sans JP', sans-serif;
            background: #f8fafc;
            user-select: none;
        }

        .kana-card-container {
            perspective: 1000px;
            aspect-ratio: 1/1.2;
        }
        .kana-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        .kana-card-inner.is-flipped {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 0.75rem;
            box-shadow: 0 2px 4px -1px rgb(0 0 0 / 0.1);
        }
        .card-front { background-color: white; border: 1px solid #e2e8f0; }
        .card-back {
            background-color: #6366f1;
            color: white;
            transform: rotateY(180deg);
            padding: 2px;
        }

        .nav-btn.active {
            color: #4f46e5;
            font-weight: bold;
            border-bottom: 3px solid #4f46e5;
        }

        .keyboard-btn {
            transition: all 0.1s;
        }
        .keyboard-btn:active {
            transform: scale(0.9);
            background-color: #e0e7ff;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .error-shake { animation: shake 0.2s ease-in-out 0s 2; }
        
        .empty-slot { opacity: 0; pointer-events: none; }
    </style>
</head>
<body class="min-h-screen text-slate-800 pb-10">

    <nav class="bg-white shadow-sm p-4 sticky top-0 z-50">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold text-indigo-600 flex items-center gap-2">
                <i class="fas fa-language"></i> å®Œæ•´æ—¥èªäº”åéŸ³å¯¦é©—å®¤
            </h1>
            <div id="score-container" class="bg-amber-100 px-3 py-1 rounded-full flex items-center gap-2 border border-amber-200">
                <i class="fas fa-trophy text-amber-500"></i>
                <span id="score-display" class="font-bold text-amber-700">0</span>
            </div>
        </div>
        <div class="max-w-4xl mx-auto flex justify-around mt-4">
            <button onclick="switchView('kana')" class="nav-btn pb-1 active" id="btn-kana">äº”åéŸ³åœ–</button>
            <button onclick="switchView('lab')" class="nav-btn pb-1" id="btn-lab">æ‰¾å–®å­—</button>
            <button onclick="switchView('dialogue')" class="nav-btn pb-1" id="btn-dialogue">å¸¸ç”¨å°è©±</button>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto p-4 md:p-6">
        
        <!-- 1. å®Œæ•´äº”åéŸ³åœ– -->
        <section id="view-kana" class="view-content">
            <div class="mb-6 text-center">
                <h2 class="text-2xl font-bold text-slate-700">æ¸…éŸ³ç™¼éŸ³è¡¨</h2>
                <p class="text-sm text-slate-500">é»æ“Šè†è½ï¼Œç¿»é¢æŸ¥çœ‹åˆç´šå–®å­—</p>
            </div>
            <div id="kana-grid" class="grid grid-cols-5 gap-2 md:gap-4"></div>
        </section>

        <!-- 2. æ‰¾å–®å­—å¯¦é©—å®¤ -->
        <section id="view-lab" class="view-content hidden">
            <div class="bg-white rounded-3xl p-6 shadow-xl mb-6 border-4 border-indigo-50">
                <div class="text-center mb-6">
                    <div id="hint-box" class="hidden mb-4 p-3 bg-indigo-50 rounded-2xl border border-indigo-100 animate-bounce">
                        <span class="text-indigo-600 font-bold">ä»»å‹™ï¼š</span>
                        <span id="hint-text" class="text-lg text-slate-700">æ‹¼å‡ºã€Œä»€éº¼ã€</span>
                    </div>
                    
                    <div id="lab-input-display" class="text-5xl font-bold text-indigo-600 tracking-widest h-20 flex items-center justify-center gap-2">
                    </div>
                    
                    <div id="found-info" class="min-h-[2.5rem] font-bold text-xl mt-2 italic text-center"></div>
                </div>

                <div class="flex flex-col gap-4">
                    <div class="flex gap-4">
                        <button onclick="submitLab()" class="flex-[2] py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-2xl font-bold text-xl shadow-lg transition-all active:scale-95">
                            <i class="fas fa-check-circle mr-2"></i>ç¢ºèªé€å‡º
                        </button>
                        <button onclick="backspaceLab()" class="flex-1 py-4 bg-slate-200 hover:bg-slate-300 text-slate-600 rounded-2xl font-bold text-xl transition-all">
                            <i class="fas fa-backspace"></i>
                        </button>
                    </div>
                    <div class="flex gap-4">
                        <button onclick="toggleHint()" class="flex-1 py-3 bg-slate-100 hover:bg-slate-200 rounded-xl font-bold text-slate-600 transition-colors">
                            <i class="fas fa-lightbulb mr-2"></i>é¡Œç›®æç¤º
                        </button>
                        <button onclick="clearLab()" class="flex-1 py-3 bg-red-50 hover:bg-red-100 rounded-xl font-bold text-red-500 transition-colors">
                            <i class="fas fa-trash-alt mr-2"></i>å…¨éƒ¨æ¸…é™¤
                        </button>
                    </div>
                </div>
            </div>

            <div id="lab-keyboard" class="grid grid-cols-5 gap-1.5 md:gap-2 bg-slate-100 p-4 rounded-3xl"></div>
        </section>

        <!-- 3. ç”Ÿæ´»å°è©± -->
        <section id="view-dialogue" class="view-content hidden">
            <h2 class="text-2xl font-bold mb-6 text-center text-slate-700">é“åœ°ç”Ÿæ´»å°è©± (10å¥ç²¾é¸)</h2>
            <div id="dialogue-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </section>

    </main>

    <script>
        // å®Œæ•´çš„äº”åéŸ³ (æ¸…éŸ³)
        const fullKana = [
            {h:'ã‚', w:'ã‚ã²ã‚‹', cn:'é´¨å­', icon:'ğŸ¦†'}, {h:'ã„', w:'ã„ã¬', cn:'ç‹—', icon:'ğŸ¶'}, {h:'ã†', w:'ã†ãˆ', cn:'ä¸Šé¢', icon:'ğŸ‘†'}, {h:'ãˆ', w:'ãˆã‚“ã´ã¤', cn:'é‰›ç­†', icon:'âœï¸'}, {h:'ãŠ', w:'ãŠã«ãã‚Š', cn:'é£¯ç³°', icon:'ğŸ™'},
            {h:'ã‹', w:'ã‹ã‚', cn:'çƒé¾œ', icon:'ğŸ¢'}, {h:'ã', w:'ã', cn:'æœ¨', icon:'ğŸŒ³'}, {h:'ã', w:'ãã‚‹ã¾', cn:'è»Š', icon:'ğŸš—'}, {h:'ã‘', w:'ã‚±ãƒ¼ã‚­', cn:'è›‹ç³•', icon:'ğŸ°'}, {h:'ã“', w:'ã“ã¾', cn:'é™€èº', icon:'ğŸª€'},
            {h:'ã•', w:'ã•ã‹ãª', cn:'é­š', icon:'ğŸŸ'}, {h:'ã—', w:'ã—ã‹', cn:'é¹¿', icon:'ğŸ¦Œ'}, {h:'ã™', w:'ã™ã„ã‹', cn:'è¥¿ç“œ', icon:'ğŸ‰'}, {h:'ã›', w:'ã›ã‚“ã›ã„', cn:'è€å¸«', icon:'ğŸ‘¨â€ğŸ«'}, {h:'ã', w:'ãã‚‰', cn:'å¤©ç©º', icon:'â˜ï¸'},
            {h:'ãŸ', w:'ãŸã¾ã”', cn:'è›‹', icon:'ğŸ¥š'}, {h:'ã¡', w:'ã¡ãš', cn: 'åœ°åœ–', icon:'ğŸ—ºï¸'}, {h:'ã¤', w:'ã¤ããˆ', cn:'æ›¸æ¡Œ', icon:'ğŸ“–'}, {h:'ã¦', w:'ã¦', cn:'æ‰‹', icon:'âœ‹'}, {h:'ã¨', w:'ã¨ã‚Š', cn:'é³¥', icon:'ğŸ¦'},
            {h:'ãª', w:'ãªã™', cn:'èŒ„å­', icon:'ğŸ†'}, {h:'ã«', w:'ã«ã‚“ã˜ã‚“', cn:'èƒ¡è˜¿è””', icon:'ğŸ¥•'}, {h:'ã¬', w:'ã¬ã‚Šãˆ', cn:'è‘—è‰²', icon:'ğŸ¨'}, {h:'ã­', w:'ã­ã“', cn:'è²“', icon:'ğŸ±'}, {h:'ã®', w:'ã®ã‚Š', cn:'æµ·è‹”', icon:'ğŸ™'},
            {h:'ã¯', w:'ã¯ãª', cn:'èŠ±', icon:'ğŸŒ¸'}, {h:'ã²', w:'ã²ã‹ã‚Š', cn:'å…‰', icon:'âœ¨'}, {h:'ãµ', w:'ãµã­', cn:'èˆ¹', icon:'ğŸš¢'}, {h:'ã¸', w:'ã¸ã³', cn:'è›‡', icon:'ğŸ'}, {h:'ã»', w:'ã»ã—', cn:'æ˜Ÿæ˜Ÿ', icon:'â­'},
            {h:'ã¾', w:'ã¾ã‚', cn:'è±†å­', icon:'ğŸ«˜'}, {h:'ã¿', w:'ã¿ã‹ã‚“', cn:'æ©˜å­', icon:'ğŸŠ'}, {h:'ã‚€', w:'ã‚€ã—', cn:'æ˜†èŸ²', icon:'ğŸ'}, {h:'ã‚', w:'ã‚', cn:'çœ¼ç›', icon:'ğŸ‘ï¸'}, {h:'ã‚‚', w:'ã‚‚ã¡', cn:'éº»ç³¬', icon:'ğŸ¡'},
            {h:'ã‚„', w:'ã‚„ã¾', cn:'å±±', icon:'â›°ï¸'}, {h:null}, {h:'ã‚†', w:'ã‚†ã', cn:'é›ª', icon:'â„ï¸'}, {h:null}, {h:'ã‚ˆ', w:'ã‚ˆã‚‹', cn:'å¤œæ™š', icon:'ğŸŒ™'},
            {h:'ã‚‰', w:'ã‚‰ã„ãŠã‚“', cn:'ç…å­', icon:'ğŸ¦'}, {h:'ã‚Š', w:'ã‚Šã‚“ã”', cn:'è˜‹æœ', icon:'ğŸ'}, {h:'ã‚‹', w:'ã‚‹ã™', cn:'ä¸åœ¨å®¶', icon:'ğŸ '}, {h:'ã‚Œ', w:'ã‚Œã„ãã†ã“', cn:'å†°ç®±', icon:'ğŸ§Š'}, {h:'ã‚', w:'ã‚ã‘ã£ã¨', cn:'ç«ç®­', icon:'ğŸš€'},
            {h:'ã‚', w:'ã‚ã«', cn:'é±·é­š', icon:'ğŸŠ'}, {h:null}, {h:null}, {h:null}, {h:'ã‚’', w:'ã‚’', cn:'(åŠ©è©)', icon:'âš“'},
            {h:'ã‚“', w:'ã‚‰ã„ãŠã‚“', cn:'ç…å­(å°¾éŸ³)', icon:'ğŸ¦'}, {h:null}, {h:null}, {h:null}, {h:null}
        ];

        // å–®å­—åº«
        const wordDictionary = [
            ...fullKana.filter(k => k.h && k.w).map(d => ({jp: d.w, cn: d.cn, icon: d.icon})),
            {jp: 'ã‚ãŸã—', cn: 'æˆ‘', icon: 'ğŸ‘¤'},
            {jp: 'ã‚ãªãŸ', cn: 'ä½ ', icon: 'ğŸ‘¤'},
            {jp: 'ãŠã¨ã“', cn: 'ç”·äºº', icon: 'ğŸ‘¨'},
            {jp: 'ãŠã‚“ãª', cn: 'å¥³äºº', icon: 'ğŸ‘©'},
            {jp: 'ãã—', cn: 'é¨å£«', icon: 'ğŸ‡'},
            {jp: 'ã‚ã„ã—', cn: 'åç‰‡', icon: 'ğŸ’³'},
            {jp: 'ãŸãª', cn: 'æ¶å­', icon: 'ğŸªœ'},
            {jp: 'ã¿ã›', cn: 'å•†åº—', icon: 'ğŸª'},
            {jp: 'ã«hon', cn: 'æ—¥æœ¬', icon: 'ğŸ—¾'},
            {jp: 'ã«ã‚', cn: 'é™¢å­', icon: 'ğŸ¡'},
            {jp: 'ã†ã¿', cn: 'æµ·', icon: 'ğŸŒŠ'},
            {jp: 'ã‹ã‚', cn: 'æ²³', icon: 'ğŸï¸'},
            {jp: 'ã™ã—', cn: 'å£½å¸', icon: 'ğŸ£'},
            {jp: 'ã«ã', cn: 'è‚‰', icon: 'ğŸ¥©'},
            {jp: 'ã¿ãš', cn: 'æ°´', icon: 'ğŸ’§'},
            {jp: 'ãŠã‹ã—', cn: 'é»å¿ƒ', icon: 'ğŸª'},
            {jp: 'ã‚ã‚', cn: 'ç³–æœ / é›¨', icon: 'ğŸ¬'},
            {jp: 'ã—ã‚', cn: 'ç™½è‰²', icon: 'âšª'},
            {jp: 'ãã‚', cn: 'é»‘è‰²', icon: 'âš«'},
            {jp: 'ã¾ã‚‹', cn: 'åœ“å½¢', icon: 'â­•'},
            {jp: 'ã¿ã¿', cn: 'è€³æœµ', icon: 'ğŸ‘‚'},
            {jp: 'ã‹ãŠ', cn: 'è‡‰', icon: 'ğŸ˜Š'},
            {jp: 'ã‚ãŸã¾', cn: 'é ­', icon: 'ğŸ‘¤'},
            {jp: 'ãã¡', cn: 'å˜´å·´', icon: 'ğŸ‘„'},
            {jp: 'ã‚ã—', cn: 'è…³', icon: 'ğŸ¦¶'},
            {jp: 'ã„ã', cn: 'å»', icon: 'ğŸƒ'},
            {jp: 'ã¿ã‚‹', cn: 'çœ‹', icon: 'ğŸ‘€'},
            {jp: 'ãã', cn: 'è½', icon: 'ğŸ‘‚'},
            {jp: 'ã­ã‚‹', cn: 'ç¡è¦º', icon: 'ğŸ˜´'},
            {jp: 'ã‹ã†', cn: 'è²·', icon: 'ğŸ›’'},
            {jp: 'ã®ã‚€', cn: 'å–', icon: 'ğŸ¥¤'},
            {jp: 'ã†ã•ã', cn: 'å…”å­', icon: 'ğŸ°'},
            {jp: 'ã„ã¡', cn: 'ä¸€', icon: '1ï¸âƒ£'},
            {jp: 'ã«', cn: 'äºŒ', icon: '2ï¸âƒ£'},
            {jp: 'ã•ã‚“', cn: 'ä¸‰', icon: '3ï¸âƒ£'},
            {jp: 'ã„ã¾', cn: 'ç¾åœ¨', icon: 'â°'},
            {jp: 'ãªã«', cn: 'ä»€éº¼', icon: 'â“'},
            {jp: 'ã ã‚Œ', cn: 'èª°', icon: 'ğŸ‘¤'},
            {jp: 'ã‚†ã‚', cn: 'å¤¢', icon: 'ğŸ’­'},
            {jp: 'ãªã¾ãˆ', cn: 'åå­—', icon: 'ğŸ“›'},
            {jp: 'ã›ã‹ã„', cn: 'ä¸–ç•Œ', icon: 'ğŸŒ'}
        ];

        // å¸¸ç”¨å°è©± 10 å¥
        const dialogues = [
            {jp: 'ã“ã‚“ã«ã¡ã¯', cn: 'ä½ å¥½ (åˆå®‰)', romaji: 'Konnichiwa'},
            {jp: 'ã‚ã‚ŠãŒã¨ã†', cn: 'è¬è¬', romaji: 'Arigatou'},
            {jp: 'ã™ã¿ã¾ã›ã‚“', cn: 'å°ä¸èµ· / è«‹å•', romaji: 'Sumimasen'},
            {jp: 'ãŠã¯ã‚ˆã†', cn: 'æ—©å®‰', romaji: 'Ohayou'},
            {jp: 'ãŠã‚„ã™ã¿', cn: 'æ™šå®‰', romaji: 'Oyasumi'},
            {jp: 'ã”ã‚ã‚“ãªã•ã„', cn: 'å°ä¸èµ·', romaji: 'Gomennasai'},
            {jp: 'ã¯ã˜ã‚ã¾ã—ã¦', cn: 'åˆæ¬¡è¦‹é¢', romaji: 'Hajimemashite'},
            {jp: 'ã©ã†ãã‚ˆã‚ã—ã', cn: 'è«‹å¤šæŒ‡æ•™', romaji: 'Douzo Yoroshiku'},
            {jp: 'ã ã„ã˜ã‚‡ã†ã¶', cn: 'æ²’é—œä¿‚ / æ²’å•é¡Œ', romaji: 'Daijoubu'},
            {jp: 'ã•ã‚ˆã†ãªã‚‰', cn: 'å†è¦‹', romaji: 'Sayounara'}
        ];

        let totalScore = 0;
        let labInput = "";
        let isHintActive = false;
        let currentMission = null;

        window.onload = () => {
            renderKanaGrid();
            renderLabKeyboard();
            renderDialogues();
        };

        function switchView(view) {
            document.querySelectorAll('.view-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`view-${view}`).classList.remove('hidden');
            document.getElementById(`btn-${view}`).classList.add('active');
            if (view === 'lab') clearLab();
        }

        function renderKanaGrid() {
            const grid = document.getElementById('kana-grid');
            grid.innerHTML = '';
            fullKana.forEach((item) => {
                const container = document.createElement('div');
                if (!item.h) {
                    container.className = 'empty-slot';
                    grid.appendChild(container);
                    return;
                }
                container.className = 'kana-card-container';
                const inner = document.createElement('div');
                inner.className = 'kana-card-inner';
                inner.onclick = () => {
                    const flipped = inner.classList.toggle('is-flipped');
                    speak(flipped ? item.w : item.h, 0.9);
                };
                inner.innerHTML = `
                    <div class="card-front"><span class="text-2xl font-bold text-indigo-600">${item.h}</span></div>
                    <div class="card-back">
                        <span class="text-xl">${item.icon || ''}</span>
                        <div class="text-[10px] font-bold">${item.w || ''}</div>
                        <div class="text-[9px] opacity-80">${item.cn || ''}</div>
                    </div>
                `;
                container.appendChild(inner);
                grid.appendChild(container);
            });
        }

        function renderLabKeyboard() {
            const kb = document.getElementById('lab-keyboard');
            kb.innerHTML = '';
            fullKana.forEach(item => {
                if (!item.h) {
                    const empty = document.createElement('div');
                    kb.appendChild(empty);
                    return;
                }
                const btn = document.createElement('button');
                btn.className = 'keyboard-btn bg-white py-3 rounded-lg shadow-sm font-bold text-lg text-slate-700 border-b-2 border-slate-200 hover:bg-indigo-50 active:border-b-0 transition-all';
                btn.innerText = item.h;
                btn.onclick = () => addToLab(item.h);
                kb.appendChild(btn);
            });
        }

        function addToLab(char) {
            speak(char, 1.1);
            if (labInput.length < 8) {
                labInput += char;
                updateLabDisplay();
            }
        }

        function backspaceLab() {
            if (labInput.length > 0) {
                labInput = labInput.slice(0, -1);
                updateLabDisplay();
            }
        }

        function updateLabDisplay() {
            document.getElementById('lab-input-display').innerText = labInput;
        }

        function submitLab() {
            if (labInput === "") return;

            const match = wordDictionary.find(item => item.jp === labInput);
            const info = document.getElementById('found-info');
            const display = document.getElementById('lab-input-display');

            if (match) {
                speak(match.jp, 0.85);
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                
                info.innerHTML = `<span class="text-green-600">æ‰¾åˆ°å–®å­—äº†ï¼ğŸ¥³ <br> <span class="text-sm">ã€Œ${match.jp}ã€æ„æ€ï¼š${match.cn} ${match.icon}</span></span>`;
                display.classList.add('text-green-500', 'scale-110');
                
                totalScore += 50;
                document.getElementById('score-display').innerText = totalScore;

                setTimeout(() => {
                    display.classList.remove('text-green-500', 'scale-110');
                    info.innerText = "";
                    if (isHintActive) setNewMission();
                    clearLab();
                }, 3500);
            } else {
                info.innerHTML = `<span class="text-red-500">æ‰¾éŒ¯å–®å­—ï¼Œè«‹é‡æ‰¾åŠ æ²¹ï¼</span>`;
                display.classList.add('error-shake', 'text-red-400');
                
                setTimeout(() => {
                    display.classList.remove('error-shake', 'text-red-400');
                    info.innerText = "";
                }, 1000);
            }
        }

        function clearLab() {
            labInput = "";
            updateLabDisplay();
            document.getElementById('found-info').innerText = "";
        }

        function toggleHint() {
            isHintActive = !isHintActive;
            const hintBox = document.getElementById('hint-box');
            if (isHintActive) {
                hintBox.classList.remove('hidden');
                setNewMission();
            } else {
                hintBox.classList.add('hidden');
            }
        }

        function setNewMission() {
            currentMission = wordDictionary[Math.floor(Math.random() * wordDictionary.length)];
            document.getElementById('hint-text').innerText = `æ‰¾å‡ºã€Œ${currentMission.cn}ã€${currentMission.icon}`;
        }

        function renderDialogues() {
            const list = document.getElementById('dialogue-list');
            list.innerHTML = '';
            dialogues.forEach(d => {
                const card = document.createElement('div');
                card.className = 'bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex justify-between items-center cursor-pointer hover:bg-indigo-50 transition-all group';
                card.onclick = () => speak(d.jp, 0.85);
                card.innerHTML = `
                    <div>
                        <div class="font-bold text-lg text-indigo-600">${d.jp}</div>
                        <div class="text-sm text-slate-500 font-medium">${d.cn}</div>
                        <div class="text-[10px] text-slate-400 italic">${d.romaji}</div>
                    </div>
                    <div class="text-indigo-300 group-hover:text-indigo-500 transition-colors"><i class="fas fa-volume-up fa-lg"></i></div>
                `;
                list.appendChild(card);
            });
        }

        function speak(text, rate = 0.85) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ja-JP';
            utterance.rate = rate; 
            
            const voices = window.speechSynthesis.getVoices();
            const preferredVoice = voices.find(v => 
                (v.lang === 'ja-JP' || v.lang === 'ja_JP') && 
                (v.name.includes('Google') || v.name.includes('Microsoft'))
            );

            if (preferredVoice) utterance.voice = preferredVoice;
            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>
